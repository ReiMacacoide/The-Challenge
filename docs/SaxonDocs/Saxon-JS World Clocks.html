<!DOCTYPE html>
<html><head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Saxon-JS World Clocks</title>
        <meta name="robots" content="noindex, nofollow">
        <meta name="viewport" content="width=768, minimum-scale=1.0, maximum-scale=1.0">
        <script type="text/javascript" src="Saxon-JS%20World%20Clocks_files/jstree.js"></script>
        <script src="Saxon-JS%20World%20Clocks_files/SaxonJS.js"></script>
        <script>
      window.onload = function() {
        SaxonJS.transform({
           stylesheetLocation: "xsl/jstree.sef.xml",
           initialTemplate: "main"
           });
      }     
        </script>
        <link href="Saxon-JS%20World%20Clocks_files/jstree.css" rel="stylesheet" type="text/css">
            
    </head>

<body>

    <div id="wrap">
        
        <div id="header" class="unselectable">
            
            <!-- bread-crumb trail -->
            
            <ul class="trail" id="trail"><li id="trail1"><a href="http://saxonica.com/">Saxonica ▷</a></li><li id="trail2"><a href="http://www.saxonica.com/saxon-js/index.xml">Saxon-JS ▷</a></li><li idt="samples" class="trail">Sample Applications ▷</li><li idt="clocks" class="trail">World Clocks</li></ul>
            
        </div>
        
        <!-- find box appears in top-left of display - normally hidden -->
        
        <div class="found">
            
            <p class="foundClosed"></p>
            
            <p class="foundNext"></p>
            
            <p class="foundPrev"></p>
            
            <p id="findstatus" class="foundCount">searching...</p>
            
        </div>
        
        <div id="foundPaths"></div>
        
        <div id="nav" class="unselectable">
            
            
            <!-- logo and search -->
            
            <div id="logo">
                
                <p class="logoBox"><img src="Saxon-JS%20World%20Clocks_files/logo_crop-mid-blue-background.gif" alt="saxonica.com" width="120" height="24"></p>
                
                
                <p class="arrowNone"></p>
                
                <p class="search"></p>
                <input id="search" style="font-family:inherit;font-size:12px;float:right;padding:2px;margin-top:4px;width:110px;border:none;">
                    
            </div>
            
            
            <!-- tree-view -->
            
            <ul id="list"><li class="closed" id="about"><span class="item">About Saxon-JS</span><ul><li id="saxonce" class="empty"><span class="item">Comparison with Saxon-CE</span></li></ul></li><li class="open" id="changes"><span class="item">Change History</span></li><li class="closed" id="starting"><span class="item">Getting started</span><ul><li id="installing" class="empty"><span class="item">Installing the Software</span></li><li id="export" class="empty"><span class="item">Exporting for JS</span></li><li id="running" class="empty"><span class="item">Running Saxon-JS</span></li></ul></li><li class="closed" id="development"><span class="item">Developing Applications</span><ul><li id="namespaces" class="empty"><span class="item">Namespaces</span></li><li id="result-documents" class="empty"><span class="item">Result documents</span></li><li id="source-documents" class="empty"><span class="item">Source documents</span></li><li id="events" class="empty"><span class="item">Handling user input events</span></li><li id="system-events" class="empty"><span class="item">Handling client system events</span></li><li id="animation" class="empty"><span class="item">Animation</span></li><li id="http" class="open"><span class="item">HTTP client</span><ul><li id="termination" class="empty"><span class="item">HTTP request termination</span></li></ul></li><li id="global" class="empty"><span class="item">Using global JavaScript functions</span></li><li id="properties" class="empty"><span class="item">Properties of JavaScript objects</span></li><li id="saxonce" class="empty"><span class="item">Migration from Saxon-CE</span></li></ul></li><li class="closed" id="ixsl-extension"><span class="item">Saxon Interactive Extensions</span><ul><li id="functions" class="open"><span class="item">Extension functions</span><ul><li id="apply" class="empty"><span class="item">ixsl:apply</span></li><li id="call" class="empty"><span class="item">ixsl:call</span></li><li id="eval" class="empty"><span class="item">ixsl:eval</span></li><li id="event" class="empty"><span class="item">ixsl:event</span></li><li id="get" class="empty"><span class="item">ixsl:get</span></li><li id="location" class="empty"><span class="item">ixsl:location</span></li><li id="page" class="empty"><span class="item">ixsl:page</span></li><li id="query-params" class="empty"><span class="item">ixsl:query-params</span></li><li id="source" class="empty"><span class="item">ixsl:source</span></li><li id="style" class="empty"><span class="item">ixsl:style</span></li><li id="window" class="empty"><span class="item">ixsl:window</span></li></ul></li><li id="instructions" class="open"><span class="item">Extension instructions</span><ul><li id="remove-attribute" class="empty"><span class="item">ixsl:remove-attribute</span></li><li id="schedule-action" class="empty"><span class="item">ixsl:schedule-action</span></li><li id="set-attribute" class="empty"><span class="item">ixsl:set‑attribute</span></li><li id="set-property" class="empty"><span class="item">ixsl:set-property</span></li><li id="set-style" class="empty"><span class="item">ixsl:set-style</span></li></ul></li><li id="conversions" class="empty"><span class="item">JS/XDM Type Conversion</span></li></ul></li><li class="open" id="api"><span class="item">JavaScript API</span><ul><li id="transform" class="open"><span class="item">SaxonJS.transform</span><ul><li id="parameters" class="empty"><span class="item">Supplying stylesheet parameters</span></li></ul></li><li id="getProcessorInfo" class="empty"><span class="item">SaxonJS.getProcessorInfo</span></li><li id="setLogLevel" class="empty"><span class="item">SaxonJS.setLogLevel</span></li><li id="xpathEvaluate" class="empty"><span class="item">SaxonJS.XPath.evaluate</span></li></ul></li><li class="open" id="conformance"><span class="item">Standards Conformance</span><ul><li id="xslt30" class="empty"><span class="item">XSLT 3.0 and XPath 3.0/3.1 Conformance</span></li><li id="dynamic-xpath" class="empty"><span class="item">Dynamic XPath evaluation</span></li><li id="regex" class="empty"><span class="item">Regular Expressions</span></li><li id="limits" class="empty"><span class="item">Limits</span></li><li id="saxon-extensions" class="empty"><span class="item">Saxon Extensions</span></li></ul></li><li class="open" id="samples"><span class="item">Sample Saxon-JS Applications</span><ul><li id="booklist" class="empty"><span class="item">Book List</span></li><li id="tour" class="empty"><span class="item">Knight's Tour</span></li><li id="cities" class="empty"><span class="item">Cities List</span></li><li id="clocks" class="empty"><span class="hot">World Clocks</span></li></ul></li><li class="closed" id="conditions"><span class="item">Licensing</span></li></ul>
            
        </div>
        
        <!-- main page -->
        
        <div id="main" style="float:left">
      <h1>World Clocks</h1>

      <p>To try out the world clocks application, visit <a href="http://www.saxonica.com/saxon-js/demos/clocks/index.xhtml" class="bodylink" target="_blank">here</a>.</p>
      <p>This example demonstrates the use of the purely XPath 3.1 API to Saxon-JS. It does not use a
         pre-compiled XSLT stylesheet, just XPath evaluation supported by Saxon-JS. To see how it
         works, view the source of the HTML page ("view source" in your browser). Particular
         features to note are:</p>
      <ul>
        <!-- <li>The Saxon-JS platform must first be initialized to set up suitable internal tables and
            polyfilled function mappings.</li>-->
         <li>The function <code>setClocks()</code> finds all the 'clock' class elements in the
            document using an XPath with the HTML document as context item, always returning the
            result as a (possibly empty) array of element nodes, by setting the
               <code>resultForm:"array"</code> option. </li>
         <li>The function <code>setClock()</code> processes a given clock in the following phases: <ol><li>The
                  time to display is computed by evaluating the <code>findTime</code> expression
                  with the clock node as context item and a map of city-timezone mappings provided
                  as a parameter. This expression first looks for an element named 'city' within the
                  clock body and if found uses the string value of this to adjust the current time
                  to the necessary timezone, as determined from the supplied map. The time is then
                  returned as a map of integers, keyed as 'hour', 'minute' and 'second'.
                  </li><li>With the time then computed, the '<code>timeIndicators</code>' are found
                  as descendants of the clock element and returned as a map of nodes labelled
                  'hour', 'minute' or 'second'. (By wrapping these found nodes in an
                     <code>array{}</code> constructor, we ensure they are presented in a canonical
                  array form: otherwise the values might be empty, a singleton node or a sequence of
                  nodes flattened to an array and would require further JavaScript logic to handle
                  these in a uniform manner.)</li><li>Rotational angles for clock hands are then
                  computed, again returning results as a map keyed by 'hour', 'minute' and
                  'second'.</li><li>Each of the indicator nodes in the clock is then updated, to the
                  value corresponding to its class. For <code>svg:*</code> elements which are not
                  text (i.e. not <code>svg:text, svg:tspan</code>), the indicator is considered a
                  rotational 'hand' and a <code>@transform</code> attribute is written to rotate the
                  given section by the corresponding angle. If the indicator node is not considered
                  graphical, it is assumed to be a text-containing element - its text content is
                  updated to the string value of the corresponding time component.</li></ol></li>
      </ul>
      <aside>This example could of course have been coded simply in XSLT and compiled for Saxon-JS
         runtime (where of course the clock bodies could have been generated programmatically), but
         it illustrates use of a pure XPath and JavaScript architecture. </aside>
   </div>
        
        <!-- footnote anchored to bottom of display -->
        
        <div id="footer">
            
            <div id="info" class="footnote">
                
                <p>Saxon-JS Documentation</p>
                
            </div>
            
            <div>
                
                <p class="arrowRight"></p>
                
                <p class="arrowLeft"></p> 
                
            </div>
            
        </div>
        
        
    </div>
      

   


</body></html>